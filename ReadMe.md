1、量化的定义
投资分为两种，判断型投资：根据各种信息以及个人过去的经验确定买卖什么，买卖多少，在什么价位进行买卖操作，如何止损等；量化投资：靠数学公式来投资。
[https://blog.csdn.net/myquant/article/details/81541861](https://blog.csdn.net/myquant/article/details/81541861)

量化投资有几个假设，有几个比较重要的是:1.价格能反应一切，也就是说价格是一切信息的最后状态，无论是内幕消息还是公开消息都会最终反映在证券的价格上，证券包括股票，期货，期权等，这是市场有效假说的一部分。2.历史会部分重演，量化要做的是总结未来的规律，对未来做出预测，也就是市场存在周期性，既然是周期性，那周期的T有大有小，也就造成了交易的高频、中频和低频，没有严格的界定，只是自己主观的感觉是高频还是低频，一般高频交易就是指频繁的交易，频率很高，中频和低频，在不同市场也不同，反正没有严格界定，有些人是看15分钟的k线交易，有些人是看日k线交易，甚至有些看宏观指标的是看周k线，月k线。
根据上面的内容，简单几个字总结一下:价格反应信息，信息得到规律


2、量化投资适用场景
在很短的短线上，整个市场的波动不再是主导因素，更重要的市场的结构，交易的方法和各种参数之间的关系，适合用量化型投资；长线一般更多是看基本面，但由于一个人的精力有限，量化讲究股票组合，平时可能只能操纵一只股票，但是有了量化的工具，股票可以一个人操纵多只，涉及一个投资广度和投资深度的问题，一般量化是投资广度更广，可以多周期多品种多策略同时进行，这就给我们控制风险带来了保障，举个例子:假设你有两只股票A,B，相关性是-1,那么你分别用100块钱买入A,B，也就是A涨10%带来是B跌10%，那无论A和B上涨还是下跌，那你也不会有盈利和亏损，也就是说如果我们找到负相关的行业，我们单纯买一个行业的股票可以会出现风险过高的情况，此时我们买入另一个行业的股票，将这部分风险给cover掉一部分。

3、回测过程
（1）设定初始值，包括本金、回测区间
（2）选择投资的对象（股票、期货或者），根据某些条件从所有的投资对象中筛选出你的投资池
（3）设定买卖条件，在什么条件下进行买入卖出，策略中最关键部分
（4）加入一些规避风险机制（如设定滑点，因为行情tick级别波动和交易中的网络延迟都会影响买入卖出的价格），使得回测更加接近真实值

4、回测的评估指标
收益率：回测期内的投资收益相较本金的增长率
最大回撤率：回测周期中累计净值最大回落的比例，数字越小，说明越稳定
年化收益率：收益率除以回测天数再乘以365
胜率：回测中盈利的交易次数除以总的交易次数
盈亏比：回测期间总利润除以总亏损
sharp率：衡量收益和风险的比例，越大越好，


5、bar 数据（即一般所说的K线数据）
下图就是一般的K线图，一根柱子即是一个bar，一般它的时间周期可以是分钟、小时、天、周和月。
![图片](https://uploader.shimo.im/f/JKo7AbU5VN8R5dbn.png!thumbnail)
开盘价、收盘价、最高价、最低价、成交量
开盘价：bar对应的时刻最早的成交价格
收盘价：bar对应的时刻最晚的成交价格
最高价：bar对应的时刻内最高的成交价格
最高价：bar对应的时刻内最低的成交价格
成交量：bar对应的时刻内成交量（A股中最小的成交量按手（100股）来记，一次交易最少成交1手）


6、tick数据（累积指定数量的Tick数据后组成Bar）
# 可参考[https://www.zhihu.com/question/26950456?sort=created](https://www.zhihu.com/question/26950456?sort=created)
# 
# 任务一
[https://github.com/Ye980226/Datawhale_quant/task1.md](https://github.com/Ye980226/Datawhale_quant)
# 任务二
[https://github.com/Ye980226/Datawhale_quant/task2.md](https://github.com/Ye980226/Datawhale_quant)
## tick和bar
数据分为tick数据和bar数据，我们常说的k线数据就是bar的数据，不过先介绍tick数据，因为bar的数据是由tick合成的,tick是分笔成交的记录，也就是理论上每一笔成交都会有1个tick数据传过来，每个tick数据是10档行情，你可以看到在交易界面，有个地方能看到挂单，分别是买一，卖1，买2，卖2，然后交易所传过来的每个tick会从买1到买10，卖1到卖10，全部传给你,然后每个买卖都会有挂单价格和挂单数量，所以买一的就是bidPrice1,bidVolume1.卖是askPrice1,askPrice2,然后还会有个lastPrice，是上一个成交的价格,bar的数据就是根据lastPrice去合成,我们知道k线数据有开高低收，开盘价，收盘价，最高价和最低价,这些都是在某个时间区域内才成立，所以我们说bar的数据前面会加一个时间限定词，比如1分钟的bar，15分钟的bar,会根据某一分钟内或者某十五分钟内的tick数据的lastPrice,然后合成1分钟和15分钟的bar数据，当然成交量也会有.
## slippage
slippage：滑点，这个是我们预想的成交价格与真实成交价格之间的差值，因为我们只能拿到历史数据，而我们成交(理想状态)是下一个tick的买价或卖价，看我们是要买还是要卖，因为我们从本地发出网络请求到交易所需要时间,本地机发到期货交易所大概在0.5s左右，算比较慢的，所以有些人会在券商那买服务器，然后会利用fpga减少网络的IO。
## buy,short,sell,cover
分别是买多，卖空，平多，平空,多和空是专业术语，一开始不太适应,但意思就是看涨和看跌，字面意思就是看这个证券之后会涨我就看涨，如果真的涨了我就能赚钱，这个就是买多(买和多是一个意思,多代表一个方向),卖空是看跌,平多和平空是平掉看涨的和平掉看跌的，我们把自己持有的仓位叫做头寸。
# 限价单和市价单
限价单，就是下一个确定价格的，确定方向的(buy,short,sell,cover)，确定数量的单。
市价单,跟限价单不同的是不需要确定价格，其他相同，直接根据市场价格成交,也就是你下一个买单的话,会根据你这个单到达交易所时间时的bidPrice1成交,如果bidPrice1的bidVolume1不能完全吃下你的单的话，会走到bidPrice2，如果还不行，依次类推
## vnpy引擎
onInit->onStart(启动时的调用顺序)
每个tick会回调到onTick函数
每个1min的bar会回调到onBar函数
可以自己注册一个bar,bar的分钟数是有限制的1min,5min,15min,30min,60min,12h,可以参考任意行情软件上的
然后注册完之后，每到这个时间也会给你推个bar到on5minBar里
你挂的单的任何变化都会走到onOrder里
(比如:你的限价单或市价单被交易所收到了,交易所会通过返回给你"未成交"这个状态
你还可以撤销订单,如果撤销成功的话,交易所会推给你一个"已撤销"状态
还有"全部成交"和"部分成交"，部分成交就是我市价单里讲的那种情况，因为每个状态都会推，所以如果你在bidPrice2的时候全部成交了,那你一共会收到两个,一个是部分成交,一个是全部成交
同一个订单的各个状态由唯一的uid控制，在vnpy引擎里是orderID.
然后你的全部成交和部分成交也会推到onTrade里，先推到onOrder再推到onTrade
当你策略停止是会推到onStop里，要么遇到异常，要么手动停止，你可以在里面存一些状态。
当你点恢复，这个一般手动点,会推到onRestore里。
## 回测
用历史数据去检验你的策略的绩效
# 夏普比率
首先有一列X的数据是每笔成交然后卖出之后的收益率
然后sum(X)/std(X)就是夏普比率

# 最大回撤
在持仓过程中，最大的浮亏，浮亏就是没有卖出变成止损，实际亏损，而是账面亏损，有希望在之后卖出的时候是赚的。

相信大家python都比我强,在vnpy库里的trader,里的vtObeject.py里有各个东西的数据结构,bar,tick,order,trade之类的，可以自己去看，根据字面猜意思，有些比较重要的就是到达时间，交易时间，我上面没有介绍。
